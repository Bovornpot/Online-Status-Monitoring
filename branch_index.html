<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤</h1>
            <p>Branch Management System - Online Status Monitoring</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalBranches">0</div>
                <div class="stat-label">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="onlineBranches">0</div>
                <div class="stat-label">‡∏™‡∏≤‡∏Ç‡∏≤ Online</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="offlineBranches">0</div>
                <div class="stat-label">‡∏™‡∏≤‡∏Ç‡∏≤ Offline</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="onlinePercentage">0%</div>
                <div class="stat-label">‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå Online</div>
            </div>
        </div>


        <div class="controls">
            <div class="data-source-info" id="dataSourceInfo"></div>

            <div class="control-row">
                <div class="control-group">
                    <label>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤, ‡∏£‡∏´‡∏±‡∏™, ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î...">
                </div>
                <div class="control-group">
                    <label>üìç ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                    <select id="provinceFilter">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>üåê ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                    <select id="statusFilter">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                        <option value="online">Online ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</option>
                        <option value="offline">Offline ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button class="btn-add" id="addBranchBtn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
                </div>
            </div>
            <div class="control-row">
                <div class="control-group">
                    <label>üìä Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (.xlsx, .xls, .csv)</label>
                    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv">
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button id="exportExcelBtn">üìä Export Excel</button>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                     <button id="exportCsvBtn">üìÑ Export CSV</button>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button id="clearDataBtn" class="btn-danger">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                </div>
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button id="historyBtn" class="btn-secondary">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
                </div>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤</th>
                        <th>‡∏†‡∏≤‡∏Ñ</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>All Zone</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°Online</th>
                        <th>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</th>
                        <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                        <!-- <th>FC.</th>
                        <th>‡πÄ‡∏Ç‡∏ï</th>
                        <th>‡∏ù‡πà‡∏≤‡∏¢</th>
                        <th>GM.</th>
                        <th>AVP</th> -->
                        <th>Shophouse/Standalone</th>
                        <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                        <!-- <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th> -->
                    </tr>
                </thead>
                <tbody id="branchTableBody">
                    </tbody>
            </table>
        </div>

        <div class="pagination-container" id="paginationContainer" style="display: none;">
            <div class="pagination-info">
                <span id="paginationInfo">‡πÅ‡∏™‡∏î‡∏á 0 - 0 ‡∏à‡∏≤‡∏Å 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
            </div>
            <div class="pagination-controls">
                <div class="page-size-selector">
                    <label>‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
                    <select id="pageSizeSelect">
                        <option value="50">50</option>
                        <option value="100" selected>100</option>
                        <option value="200">200</option>
                        <option value="500">500</option>
                    </select>
                </div>
                <button id="firstPageBtn">‚èÆÔ∏è ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                <button id="prevPageBtn">‚óÄÔ∏è ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                <span id="currentPageInfo">‡∏´‡∏ô‡πâ‡∏≤ 1 ‡∏à‡∏≤‡∏Å 1</span>
                <button id="nextPageBtn">‚ñ∂Ô∏è ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                <button id="lastPageBtn">‚è≠Ô∏è ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</button>
            </div>
        </div>
    </div>

    <div id="branchModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalBtn">&times;</span>
            <h2 id="modalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="branchForm">
                <input type="hidden" id="editingId" name="id">
                <div class="form-grid">
                    <div class="form-group">
                        <label>‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô *</label>
                        <input type="text" id="storeCode" name="storeCode" required>
                    </div>
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤ *</label>
                        <input type="text" id="branchName" name="branchName" required>
                    </div>
                    <div class="form-group">
                        <label>‡∏†‡∏≤‡∏Ñ *</label>
                        <select id="region" name="region" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ</option>
                            <option value="BE">BE</option>
                            <option value="BG">BG</option>
                            <option value="BN">BN</option>
                            <option value="BS">BS</option>
                            <option value="BW">BW</option>
                            <option value="CM">CM</option>
                            <option value="NEL">NEL</option>
                            <option value="NEU">NEU</option>
                            <option value="PK">PK</option>
                            <option value="RC">RC</option>
                            <option value="REL">REL</option>
                            <option value="REU">REU</option>
                            <option value="RN">RN</option>
                            <option value="RSL">RSL</option>
                            <option value="RSU">RSU</option>
                            <option value="UB">UB</option>
                            <option value="YL">YL</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="status" name="status">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                            <option value="CO">CO</option>
                            <option value="SBP">SBP</option>
                            <option value="Sub-Area">Sub-Area</option>
                            <option value="‡∏õ‡∏ï‡∏ó">‡∏õ‡∏ï‡∏ó</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>All Zone</label>
                        <select id="allZone" name="allZone">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å All Zone</option>
                            <option value="Bangkok">Bangkok</option>
                            <option value="Region">Region</option>
                            <option value="Sub-Area">Sub-Area</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°Online *</label>
                        <select id="onlineStatus" name="onlineStatus" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                            <option value="‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Online">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Online</option>
                            <option value="‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Online">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Online</option>
                            <option value="‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV">‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ *</label>
                        <input type="text" id="district" name="district" required>
                    </div>
                    <div class="form-group">
                        <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î *</label>
                        <input type="text" id="province" name="province" required>
                    </div>
                    <div class="form-group">
                        <label>FC.</label>
                        <input type="text" id="fc" name="fc">
                    </div>
                    <div class="form-group">
                        <label>‡πÄ‡∏Ç‡∏ï</label>
                        <input type="text" id="zone" name="zone">
                    </div>
                    <div class="form-group">
                        <label>‡∏ù‡πà‡∏≤‡∏¢</label>
                        <input type="text" id="department" name="department">
                    </div>
                    <div class="form-group">
                        <label>GM.</label>
                        <input type="text" id="gm" name="gm">
                    </div>
                    <div class="form-group">
                        <label>AVP</label>
                        <input type="text" id="avp" name="avp">
                    </div>
                    <div class="form-group">
                        <label>Shophouse/Standalone</label>
                        <select id="shopType" name="shopType">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                            <option value="Shophouse">Shophouse</option>
                            <option value="Standalone">Standalone</option>
                            <option value="PB">PB</option>
                            <option value="SA">SA</option>
                            <option value="SH">SH</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" id="cancelModalBtn">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeDetailsModalBtn">&times;</span>
            <h2 id="detailsModalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≤‡∏Ç‡∏≤</h2>
            
            <div id="detailsModalBody">
                <div class="details-grid">
                    <div class="details-label">‡∏£‡∏´‡∏±‡∏™‡∏£‡πâ‡∏≤‡∏ô:</div><div class="details-value">Loading...</div>
                    <div class="details-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏Ç‡∏≤:</div><div class="details-value">Loading...</div>
                </div>
            </div>

            <div class="form-actions" style="margin-top: 30px;">
                <button id="detailsModalEditBtn" class="btn-edit">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                <button id="detailsModalDeleteBtn" class="btn-danger">üóëÔ∏è ‡∏•‡∏ö</button>
            </div>
        </div>
    </div>

    <div id="exportModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" id="closeExportModalBtn">&times;</span>
            <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</h2>
            <form id="exportForm">
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå)</label>
                    <input type="text" id="exportFileName" required>
                    <small style="color: #666; margin-top: 5px;">‡πÄ‡∏ä‡πà‡∏ô branch_data_q3_2025</small>
                </div>
                <div class="form-actions" style="margin-top: 20px;">
                    <button type="submit">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
                    <button type="button" id="cancelExportModalBtn">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="notificationModal" class="modal">
        <div class="modal-content" style="max-width: 450px; text-align: center;">
            
            <div class="notification-icon" id="notificationIcon"></div>

            <h2 id="notificationTitle" style="margin-top: 15px;"></h2>

            <p id="notificationMessage" style="color: #666; line-height: 1.6;"></p>

            <div class="form-actions" id="notificationActions" style="margin-top: 25px;">
                </div>

        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" id="closeHistoryModalBtn">&times;</span>
            <h2>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
            <div class="history-log-container" id="historyLogContainer">
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥...</p>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/dexie@3/dist/dexie.min.js"></script>
    <script src="script.js" defer></script> 
</body>
</html>